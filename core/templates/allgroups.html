<!-- group_statistics.html -->
{% extends 'base.html' %}
{% load static %}
{% load time_tag %}
{% block content %}
<div class="mx-5 md:mx-10">
  <div
    class="hidden md:flex text-center bg-sky-700 flex-col rounded-t-2xl pb-10 mx-10"
  ></div>
  <main class="flex flex-col justify-center rounded-2xl pb-3 pt-10 bg-sky-900 h-full">
    <div class="flex flex-col bg-gray-200 mb-3  rounded-2xl w-full p-3 my-3 md:p-6 md:my-0">
    <div class="container-fluid">
        {% if flag %}
            <h1 class="text-left text-lg font-semibold truncate">Статистика групп</h1>
        {% else %}
            <h1 class="text-left text-lg font-semibold truncate">Статистика команд</h1>
        {% endif %}
        <div class=" w-full mt-5 bg-white shadow  rounded-xl">
        <table class="table table-striped" id="comanda">
            <thead class="table-dark text-center">

            <tr>
                <th> {% if flag %}Группа{% else %} Команда {% endif %}</th>
                <th>Участники</th>
                <th>Баллы</th>
                <th>Дистанция</th>
                <th>Общее Время</th>
                <th>Темп</th>
                <th>Пробежки</th>
            </tr>
            </thead>
            <tbody>

            {% for team in group_data %}

                {##}
                {#                TODO сделать  дропдаун членов группы или хуй с ним#}
                {##}
                <tr>
                    <td> {% if flag %} <a href="{% url 'viewGroup' team.group.id %}"> {% else %}
                        <a href="{% url 'oneTeamView' team %}">{% endif %}{{ team }}</a>
                    </td>
                    {% if flag %}
                        <td>{{ team.group_total_members }}</td>
                        <td>{{ team.group_total_balls }}</td>
                        <td>{{ team.group_total_distance }}</td>
                        <td>{{ team.group_total_time }}</td>
                        <td>{{ team.group_average_temp|time:"i:s" }}</td>
                        <td>{{ team.group_total_runs }}</td>

                    {% else %}
                        <td>{{ team.comands_total_members }}</td>
                        <td>{{ team.comand_total_balls }}</td>
                        <td>{{ team.comand_total_distance }}</td>
                        <td>{{ team.comand_total_time }}</td>
                        <td>{{ team.comand_average_temp|time:"i:s" }}</td>
                        <td>{{ team.comand_total_runs }}</td>


                    {% endif %}
                </tr>

                {##}
                {#            этот кусок можно разкоменнтить для вывода статистики по участникам групп#}
                {#                {% for user in data.users %}#}
                {#                    {% for stat in data.user_stats %}#}
                {#                        {% if stat.runner_stat == user %}#}
                {#                            <tr>#}
                {#                                <td>{{ user.username }}</td>#}
                {#                                <td>{{ stat.total_balls }}</td>#}
                {#                                <td>{{ stat.total_distance }}</td>#}
                {#                                <td>{{ stat.total_time|time:"H:i:s" }}</td>#}
                {#                                <td>{{ stat.total_average_temp|time:"i:s" }}</td>#}
                {#                                <td>{{ stat.total_days }}</td>#}
                {#                                <td>{{ stat.total_runs }}</td>#}
                {#                            </tr>#}
                {#                        {% endif %}#}
                {#                    {% endfor %}#}
                {#                {% endfor %}#}
            {% endfor %}
            </tbody>
        </table>
        </div>
    </div>
</div>
</main>
</div>
{% endblock %}

{% block extrascripts %}

    <script>

        new DataTable('#comanda', {
                order: [[2, 'desc']],

            columnDefs: [
                {targets: '_all', className: 'dt-body-center  dt-head-center'},
                {
                    defaultContent: "-",
                    targets: "_all"
                }

            ],
            
            language: {
                processing: "Подождите...",
                search: "",
                lengthMenu: "Показать _MENU_ записей",
                info: "Записи с _START_ до _END_ из _TOTAL_ записей",
                infoEmpty: "Записи с 0 до 0 из 0 записей",
                infoFiltered: "(отфильтровано из _MAX_ записей)",
                loadingRecords: "Загрузка записей...",
                zeroRecords: "Записи отсутствуют.",
                emptyTable: "В таблице отсутствуют данные",
                paginate: {
                    first: "Первая",
                    previous: "Предыдущая",
                    next: "Следующая",
                    last: "Последняя",
                },
                searchPlaceholder: "Поиск команды/группы",
            },
            
        });
    </script>
{% endblock %}%}